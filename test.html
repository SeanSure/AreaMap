<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/three/0.80.0/three.js"></script>

    <style>
        body {
            /* set margin to 0 and overflow to hidden, to
             use the complete page */
            margin: 0;
            overflow: hidden;
        }
    </style>

<body>

<!-- Div which will hold the Output -->
<div id="WebGL-output" style="width: 1000px;height: 500px;">
</div>

<!-- Javascript code that runs our Three.js examples -->
<script type="text/javascript">

    // once everything is loaded, we run our Three.js stuff.
    function init() {

        var scene = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera( 70, 0.5, 1, 1000);
        var renderer = new THREE.WebGLRenderer();

        var texture = new THREE.TextureLoader().load( "./images/animals/cat.jpg" );
        //material.map = texture;//材质的Map属性用于添加纹理
        var geometry = new THREE.CubeGeometry( 5, 5, 5);
        var material = new THREE.MeshPhongMaterial( { color: "#fff"} );


        var mesh = new THREE.Mesh(geometry, material );
        scene.add( mesh );

        var light = new THREE.DirectionalLight( 0xffffff );
        light.position.set( 0, 1, 1 ).normalize();
        scene.add(light);

        document.getElementById( "WebGL-output" ).appendChild( renderer.domElement );
        renderer.setSize( window.innerWidth, window.innerHeight );

        setInterval( function () {
            renderer.render( scene, camera );
        }, 100 );

    }
    //window.onload = init

    var texture = new THREE.TextureLoader().load( "./images/policeman_128x256.png" );

    var scene = new THREE.Scene();
    var camera = new THREE.PerspectiveCamera( 45
        , 0.5
        , 0.1, 1000 );
    var renderer = new THREE.WebGLRenderer();
    renderer.setClearColor( 0xEEEEEE );
    renderer.setSize( 1000, 500 );

    var planeGeometry = new THREE.PlaneGeometry( 60, 20, 1, 1 );
    var planeMaterial = new THREE.MeshBasicMaterial( { color: 0xcccccc } );
    var plane = new THREE.Mesh( planeGeometry, planeMaterial );
    plane.rotation.x = -0.5 * Math.PI;
    plane.position.x = 15;
    plane.position.y = 0;
    plane.position.z = 0;

    scene.add( plane );


    var light = new THREE.DirectionalLight( 0xffffff );
    light.position.set( 0, 1, 1 ).normalize();
    scene.add(light);

    var cubeGeomery = new THREE.CubeGeometry( 4, 4, 4 );
    cubeGeomery = new THREE.CircleGeometry( 4, 32 );
    var cubeMaterial = new THREE.MeshBasicMaterial( {
        color: 0xffffff
    } );
    cubeMaterial.map = texture;
    var cube = new THREE.Mesh( cubeGeomery, cubeMaterial );
    cube.position.x = -4;
    cube.position.y = 3;
    cube.position.z = 0;
    scene.add( cube );


    camera.position.x = -30;
    camera.position.y = 40;
    camera.position.z = 30;
    //    camera.lookAt( scene.position );
    camera.lookAt( new THREE.Vector3( 0, 0, 0 ) );
    //    camera.lookAt( cube.position );

    document.getElementById( "WebGL-output" ).appendChild( renderer.domElement );


    var raycaster = new THREE.Raycaster();
    var mouse = new THREE.Vector2(), INTERSECTED;
    document.addEventListener( 'mousemove', onDocumentMouseMove, false );

    function onDocumentMouseMove( event ) {
        event.preventDefault();
        mouse.x = ( event.clientX / 1000 ) * 2 - 1;
        mouse.y = -( event.clientY / 500 ) * 2 + 1;
    }
    function render () {
        requestAnimationFrame( render );

        raycaster.setFromCamera( mouse, camera );
        var intersects = raycaster.intersectObjects( scene.children );
//        var mesh = intersects[ 0 ].object;
//        console.info( mesh.material.color );

        if ( intersects.length > 0 ) {
            if ( INTERSECTED != intersects[ 0 ].object ) {
                if ( INTERSECTED ) INTERSECTED.material.color.setHex( INTERSECTED.currentHex );
                INTERSECTED = intersects[ 0 ].object;
                INTERSECTED.currentHex = INTERSECTED.material.color.getHex();
                INTERSECTED.material.color.setHex( 0xff0000 );
                console.info( INTERSECTED.material.map instanceof THREE.Texture);
            }
        } else {
            if ( INTERSECTED ) INTERSECTED.material.color.setHex( INTERSECTED.currentHex );
            INTERSECTED = null;
        }

        renderer.render( scene, camera );
    }

    render();


</script>
</body>
</html>